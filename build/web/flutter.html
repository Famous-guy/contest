<!-- <!DOCTYPE html>
<html>

<head>
    <title>IFrame Example</title>
</head>

<body>
    <iframe src="https://pay.100pay.co/pay/66417f18c536a8002cff2c26" width="100%" height="100%"></iframe>
</body>

</html> -->

<!-- <!DOCTYPE html>
<html>

<head>
    <title>IFrame Example</title>
</head>

<body>
    <iframe id="paymentIframe" width="100%" height="100%" frameborder="0"></iframe>

    <script>
        function setIframeSrc(url) {
            var iframe = document.getElementById('paymentIframe');
            iframe.src = url;
        }
    </script>
</body>

</html> -->

<!-- <!DOCTYPE html>
<html>

<head>
    <title>IFrame Example</title>
</head>

<body>
    <iframe id="paymentIframe" width="100%" height="100%" frameborder="0"></iframe>

    <script>
        function setIframeSrc(url) {
            var iframe = document.getElementById('paymentIframe');
            iframe.src = url;
        }

        // Example function to handle events and send messages to Flutter
        function handleMessage(event) {
            const message = event.data;
            // Handle the message here, for example:
            console.log('Received message:', message);
            // You can send the message to Flutter using postMessage if needed
        }
        window.addEventListener('load', handleMessage);
    </script>
</body>

</html> -->

<!DOCTYPE html>
<html>

<head>
    <title>IFrame Example</title>
</head>

<body>
    <iframe id="paymentIframe" width="100%" height="100%" frameborder="0"></iframe>

    <script>
        function setIframeSrc(url) {
            var iframe = document.getElementById('paymentIframe');
            iframe.src = url;
        }

        // Example function to handle events and send messages to Flutter
        function handleMessage(event) {
            const data = event.data;
            console.log({
                type: typeof data,
                data
            });
            if (typeof data !== "string") return;
            let checkData = data.split("_");
            if (checkData.length === 2 && checkData[0] === "100PAY-PAYMENT-REF") {
                // Call the charge.onPayment function with the payment reference
                charge.onPayment(checkData[1]);
            }
        }

        // Listen for the "load" event on the iframe
        document.getElementById('paymentIframe').addEventListener('load', () => {
            // Perform actions when the iframe finishes loading
            document.getElementById("show100PayWrapper").classList.add("show");
            // Add any additional actions here, such as appending elements to the DOM
            // Example:
            // img_wrapper.appendChild(vic_hand_img);
            // img_wrapper.appendChild(connected_img);

            // Add event listener for messages from the iframe
            window.addEventListener("message", handleMessage);
        });
    </script>
</body>

</html>